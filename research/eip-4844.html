<!DOCTYPE html>
<html data-wf-page="659ac539a5a2f97fb6861e76" data-wf-site="6594359b0f0aa758b21d5c90">
<head>
  <meta charset="utf-8">
  <title>EIP-4844</title>
  <meta content="EIP-4844" property="og:title">
  <meta content="EIP-4844" property="twitter:title">
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <meta content="Webflow" name="generator">
  <link href="css/normalize.css" rel="stylesheet" type="text/css">
  <link href="css/webflow.css" rel="stylesheet" type="text/css">
  <link href="css/asxn_res_webflow.css" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com" rel="preconnect">
  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin="anonymous">
  <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script>
  <script type="text/javascript">WebFont.load({  google: {    families: ["Ubuntu:300,300italic,400,400italic,500,500italic,700,700italic"]  }});</script>
  <script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
  <link href="images/favicon.ico" rel="shortcut icon" type="image/x-icon">
  <link href="images/webclip.png" rel="apple-touch-icon">
</head>
<body>
  <div data-animation="default" data-collapse="medium" data-duration="400" data-easing="ease" data-easing2="ease" role="banner" class="navbar w-nav">
    <div class="container w-container">
      <nav role="navigation" class="nav-menu w-nav-menu">
        <a href="index.html" class="w-nav-link">Research</a>
      </nav>
      <div class="w-nav-button">
        <div class="w-icon-nav-menu"></div>
      </div>
    </div>
  </div>
  <section>
    <div class="w-layout-blockcontainer w-container">
      <h1 class="heading-2">EIP-4844: L2&#x27;s &amp; Valuations Post Proto-danksharding</h1>
      <div>Written by Mize, 0xMunehisa &amp; Boccaccio<br><br>1st of August 2023 </div>
    </div>
  </section>
  <section class="section-3">
    <div class="w-layout-blockcontainer w-container">
      <div class="text-block"><strong class="bold-text-2">Overview</strong><br><br><strong>Layer 2 Solutions<br><br>‍</strong>The Ethereum mainnet is currently processing an average of 12 transactions per second and during times of high network activity, the cost to transact has reached unusable levels for the majority of users. This scalability issue stems from the fact that each node in the network is required to store and validate all transactions that have occurred on the network.</div><img src="images/ep1.webp" loading="lazy" sizes="(max-width: 767px) 96vw, (max-width: 991px) 728px, 940px" srcset="images/ep1-p-500.webp 500w, images/ep1-p-800.webp 800w, images/ep1-p-1080.webp 1080w, images/ep1.webp 1456w" alt="" class="image">
      <div>In order to combat this issue and scale Ethereum, Layer 2 solutions (L2) were invented. A layer 2 is a separate blockchain that extends Ethereum and inherits the security guarantees of Ethereum. An L2 is essentially a separate blockchain whereby users transact off the main chain (Ethereum). Each layer 2 solution has its own set of security guarantees and trade-offs. The most popular form of layer-2 scaling on Ethereum are Rollups (Arbitrum, Optimism, zkSync).<br><br>‍<strong>Rollups<br><br>‍</strong>Rollups are L2 solutions that process transactions for the L1, before settling back to the L1. A standard transaction on Ethereum is typically 156 bytes, with the signature being the most data dense. Therefore, rollups process many transactions on the L2 execution environment before bundling them up into one transaction to post to the L1 for regular state verification. The act of bundling up many transactions into one reduces the gas paid for each transaction, since it is split across many instead of just one. Not all rollups are equal however and there are a number of different types:<br><br>- Smart contract rollups<br>- Optimistic rollups (Arbitrum, Optimism)<br>- Zero-Knowledge rollups (Matic’s  zkEVM, zkSync, Scroll)<br>- Celestiums<br>- Enshrined rollups<br>- Sovereign rollups<br><br>‍<strong>Smart Contract Rollups<br><br>‍</strong>Smart contract rollups are rollups whereby users send their funds to a rollup smart contract on the L1 and this smart contract then manages the transactions and changes in state. <br><br>A key component of rollups and blockchains in general are Merkle trees. Merkle trees are data structures that store the state of everyone&#x27;s funds and the transactions that occurred, allowing the L1 to verify the state on the L2 without downloading the entire state. Simply, users interact and make transactions on the L2 (thereby changing the state) with their funds and the L2 will periodically send a Merkle root of the state to the L1 so that the L1 can verify the state of the chain.<br><br>Alongside posting the Merkle root to the L1, the L2 has to post enough Merkle tree change data so that users are able to fully recreate the Merkle tree themselves. Without this data being made available, users would be stuck on the L2 if the L2 went down for whatever reason. The L1 smart contract therefore has ‘emergency functions’ whereby users can withdraw their funds from the smart contract rollup in the event the L2 goes down. You can see the relevant risk information for each major L2 <a href="https://l2beat.com/scaling/risk">below.</a>
      </div>
      <div class="w-layout-blockcontainer container-2 w-container"><img src="images/ep2.webp" loading="lazy" sizes="(max-width: 767px) 96vw, (max-width: 991px) 728px, 940px" srcset="images/ep2-p-500.webp 500w, images/ep2-p-800.webp 800w, images/ep2-p-1080.webp 1080w, images/ep2.webp 1456w" alt="" class="image"></div>
      <div><strong>Proofs<br><br>‍</strong>The L1 needs some sort of proof to ensure that the Merkle root sent by the L2 is in fact valid and this is where the two major smart contract rollups differ. The two main proofs used are fraud proofs and zero-knowledge proofs.<br><br><br>‍<strong>Optimistic Rollups<br><br>‍</strong>Optimistic rollups like Arbitrum and Optimism use fraud proofs to finalize state. Fraud proofs work as below:<br><br>1. The L2 nodes post a Merkle root to the L1 smart contract along with a small bond<br>‍<br>2. The L1 smart contract by default trusts the L2 node and this is where the term ‘Optimistic’ comes from - the L1 optimistically trusts the L2 update.<br>‍<br>3. However, this state change does not become final for 7 days.<br><br>4. In those 7 days, someone can submit a proof that the Merkle root submitted is fraudulent and this would revert the update and penalize the L2 node by giving the bond submitted to the reporter of the fraudulent update.<br><br>5. The reporter is able to prove the update was fraudulent by verifying all transactions that happened in the state root change and by confirming each of the signatures on these transactions are valid. This is because the L2 nodes post the Merkle root and enough Merkle change data to recreate the Merkle tree.<br><br>6. If the state transition is not contested in the 7 day contention period, the update is finalized and considered immutable.<br><br><br>‍<strong>Zero-Knowledge Rollups<br><br>‍</strong>Zero-knowledge rollups use zero-knowledge proofs. They work like this: <br><br>1. The Layer 2 nodes posts a Merkle root to the L1 smart contract along with a ZK proof that proves the L2 correctly processed transactions and produced a new Merkle root.<br><br>2. If the Layer 2 node were to try post a fraudulent update, they wouldn’t be able to produce a valid ZK proof and thus the L1 smart contract would not accept the new Merkle root.<br><br>3. The state update is settled instantly once the ZK proof have been verified.<br>‍<br><br>‍<strong>Sequencers<br><br>‍</strong>A sequencer is the mechanism by which L2s gather and post transactions back to the Ethereum base chain. In their current, centralized state, they work like this:<br><br>1. Users submit transactions on the L2 - DeFi, NFTs, send/receive and so on.<br><br>2. These transactions are gathered by the centralized sequencer.<br><br>3. These transactions (calldata / state differentials) are then ordered by the sequencer (block building) into a single block or batched transaction. <br><br>4. Currently, L2 sequencers order these transactions using a first-in-first out (FIFO) ordering approach.<br><br>5. The sequencer then submits this batched transaction back to the Ethereum mainnet for inclusion in a block.</div><img src="images/ep3.webp" loading="lazy" sizes="(max-width: 767px) 96vw, (max-width: 991px) 728px, 940px" srcset="images/ep3-p-500.webp 500w, images/ep3-p-800.webp 800w, images/ep3-p-1080.webp 1080w, images/ep3.webp 1456w" alt="" class="image">
      <div>In their current state, the sequencers of rollups are centralised and controlled by one entity (Offchain labs for Arbitrum and Optimism PBC for Optimism). This centralisation creates a single point of failure for the rollups and can result in liveliness issues (and a lack of censorship resistance) - if the sequencer goes down, the L2 cannot operate properly.<br><br>For example, in early June Arbitrum’s sequencer experienced a bug causing its batches to revert on-chain, leading to the loss of gas cost for sending the batch. For a short period of time the Batch Submitter had no gas and was not processing transactions properly to Ethereum.</div>
      <div class="w-layout-blockcontainer container-7 w-container"><img src="images/ep4.webp" loading="lazy" sizes="(max-width: 767px) 96vw, (max-width: 991px) 728px, 877px" srcset="images/ep4-p-500.webp 500w, images/ep4-p-800.webp 800w, images/ep4.webp 877w" alt="" class="image"></div>
      <div><strong>L2 Gas Fees</strong><br><br>Now we shall examine how the two major smart contract rollups calculate the gas fees a user will pay and it’s impacts on the centralised sequencer’s bottom line.<br><br>On both Arbitrum and Optimism, users pay two costs to transact:<br><br>1. L2 gas/execution fee<br><br>2. L1 calldata/security fee<br>‍<br><br><strong>L2 Gas/Execution Fee<br><br>‍</strong>The L2 gas fee is similar to how Ethereum gas fees work. Each transaction on an L2 will have to pay a gas/execution fee, equal to the amount of gas used by the transaction, multiplied by the current gas price attached to the transaction.<br><br>‍<em>L2_gas_price * L2_gas_used <br></em><strong><em><br><br><br>‍</em>L1 calldata/security fee<br><br>‍</strong>The L1 calldata fee is paid to cover the cost to post transactions back to Ethereum. This fee exists because the Sequencer, or the batch poster which posts the Sequencer’s transaction batches on Ethereum, pays L1 gas to post transactions on Ethereum.<br><br>‍<em>L1_gas_price_estimate * (L1_calldata_size + L1_buffer)<br></em><strong><em><br><br><br>‍</em>Sequencer Revenue Model<br><br>‍</strong>In their current forms, Optimistic Rollups (ORUs) generate revenue via an operation of a single centralized sequencer. In the future, ORUs are expected to eventually decentralize, which would open the door for other revenue streams via MEV, or requiring sequencer operators to stake native tokens / share a cut of revenue. <br><br>But for now, in the simplest representation of this, we can think of the sequencer charging ORU users an L2 transaction fee (sequencer revenue), and having to pay L1 gas fees to submit a batch containing user’s L2 transaction data onto the Ethereum network (cost #1) as well as having to pay operational costs of running the sequencer (cost #2).</div><img src="images/ep5.webp" loading="lazy" sizes="(max-width: 767px) 96vw, (max-width: 991px) 728px, 940px" srcset="images/ep5-p-500.webp 500w, images/ep5-p-800.webp 800w, images/ep5-p-1080.webp 1080w, images/ep5.webp 1456w" alt="" class="image">
      <div>Going a step further, we can break down the revenues and costs into their specific components. While different ORUs (e.g. Arbitrum, Optimism) don’t share the exact same pricing formulas, they follow a general framework:</div>
      <div class="w-layout-blockcontainer container-3 w-container"><img src="images/ep6.webp" loading="lazy" sizes="(max-width: 767px) 96vw, (max-width: 991px) 728px, 940px" srcset="images/ep6-p-500.webp 500w, images/ep6-p-800.webp 800w, images/ep6-p-1080.webp 1080w, images/ep6.webp 1456w" alt="" class="image"></div>
      <div><strong>Revenues (L2 Gas Fees)<br><br>‍</strong>Fees = L1_gas_price_estimate * (L1_calldata_size + L1_buffer) + L2_gas_price * L2_gas_used <br><br><br><br>‍<strong>Costs<br><br>‍</strong>Costs = L1_actual_gas_price * L1_calldata_size + Sequencer_operational_costs<br><br><br><br>‍<strong>L2 Fee pricing<br><br>‍</strong>In all ORUs, L2 fee prices are a function of L1 computation size, L1 computation costs, L2 computation size, and L2 computation costs.<br><br>Given all L2 sequencers incur a cost when posting batches / proofs back onto the L1 mainnet, it is only logical that the dynamic costs of mainnet settlement are passed back on to the user when executing an L2 transaction. <br><br>L2 Fee pricing works differently on Arbitrum and Optimism. A very important distinction between the two lies in the way Optimism and Arbitrum computes the cost of L1 computation. Arbitrum uses an oracle that prices L1 compute, meaning that without a governance vote, the oracle prices L1 compute in the same way pre and post 4844. However, Optimism’s L1 compute contains a dynamic overhead (scalar) variable that can be tweaked by the Optimism team to adjust L1 compute costs.<br><br><br><br>‍<strong>Arbitrum<br><br>‍</strong>Arbitrum’s L2 Fee pricing implements a concept of ‘2-Dimensional Gas Fees’, where the gas limit is a function of the L2 gas units used, L1 gas units used and estimated L1 gas price.<br><br><strong><em>‍</em><em>Transaction fees (TXFEES) = L2 Gas Price (P) * Gas Limit (G)<br><br></em></strong><em>where :<br>‍<br>- G = (L2G + ((L1P * L1S) / P))<br>- P = L2 gas price<br>- L1P = Estimated L1 gas price<br>- L1S = Estimated L1 gas units used<br><br>‍</em>From this, we note that:<br><br>- L2 gas limit goes down with an increase in L2 gas price.<br>‍<br>- L2 gas limit increases with L2 computation, L1 gas price and L1 computation.<strong><br><br><br>Optimism<br><br>‍</strong>Like Arbitrum, Optimism’s transactions fees take into account the cost of both L1 and L2 computation. Optimism refers to these as the <strong>L2 execution fee </strong>and <strong>L1 data/security fee</strong>.<br><br><strong><em>‍</em><em>Fees charged = L2 execution fee + L1 data/security fee</em></strong><em><br><br>where:<br><br>- L2_execution_fee = (l2_base_fee + l2_priority_fee) * (l2_gas_used)<br>- L1_data_fee = l1_gas_price * (tx_data_gas + fixed_overhead) * dynamic_overhead<br><br>‍</em>Note:<br><br>- The <strong>dynamic_overhead</strong> variable is a variable set by the Optimism team to ensure that their sequencer is adequately compensated for the gas costs incurred when submitting transaction batches back onto the L1 network.<br><br>- Currently it is set to 0.684, which indicates that the sequencer is subsidizing gas costs.<br><br>- Historically, this has been predominantly set above 1, which indicates the sequencer is charging extra to maintain an L1 settlement gas buffer.</div>
      <div class="w-layout-blockcontainer container-4 w-container"><img src="images/ep7.webp" loading="lazy" sizes="(max-width: 767px) 96vw, (max-width: 991px) 728px, 940px" srcset="images/ep7-p-500.webp 500w, images/ep7-p-800.webp 800w, images/ep7-p-1080.webp 1080w, images/ep7.webp 1168w" alt="" class="image"></div>
      <div><strong>Dynamic Overhead / L1 Scalar Fees over time</strong></div><img src="images/ep8.webp" loading="lazy" sizes="(max-width: 767px) 96vw, (max-width: 991px) 728px, 940px" srcset="images/ep8-p-500.webp 500w, images/ep8-p-800.webp 800w, images/ep8-p-1080.webp 1080w, images/ep8.webp 1208w" alt="" class="image">
      <div><strong>EIP-4844 <br><br>‍</strong>Currently, Optimistic rollups have cheap costs for layer-2 execution and storage but in order to comply with data availability, the posting of data to layer-1 still remains costly for users.<br><br>Data is published to Ethereum&#x27;s layer-1 using the calldata opcode, therefore both Arbitrum and Optimism have been implementing calldata compression algorithms such as Zlib and the brotli compression algorithm. This publishing of data is expensive and makes up 80-90% of the transaction fees that L2 users pay.<br><br>However, between October 2023 and February 2024 the highly touted Ethereum improvement proposal (EIP-4844, Proto-danksharding) is scheduled to launch. EIP-4844 proposes the addition of a novel transaction type to Ethereum that allows the acceptance of &quot;blobs&quot; of data. The &quot;blobs&quot; are removed or pruned after approximately two weeks, unlike the permanent storage of existing calldata. The size of these blobs are designed to be small enough to reduce storage overhead on the Mainnet chain. <br><br>High transaction fees on Ethereum Layer 1 (L1) are a major cost for L2 rollups when posting batches and proofs. The effect that EIP-4844 has on this is that it significantly reduces the L1 cost overhead while allowing batch data to be available long enough for any fraud proofs to be posted. Current estimates place this cost saving factor from anywhere between 10x-100x of current L1 batch posting costs.<br><br><strong><br><br>High Level Overview of Impact on Sequencer Revenue<br><br>‍</strong><strong>Predicted change in model due to EIP-4844<br><br>‍</strong>Before diving into the changes that we expect to see to both Arbitrum and Optimism, it is important that we take into account the differences in L1 compute pricing by both Arbitrum and Optimism (as explained in the section earlier <strong>L2 Fee Pricing</strong>. Given Arbitrum’s L1 pricing oracle, we now know that it is likely we see Arbitrum passing on 100% of fees to users (unless we see a governance vote). This is not the same for Optimism, as they still control the dynamic overhead variable (allowing them to tweak the amount of savings passed on).<br><br>Nonetheless, the sensitivity tables below give us an insight into possible outcomes post EIP-4844, and may be useful for Arbitrum if they decide to have a DAO vote to determine a savings % rate passed on.<br><br><br><br>‍<strong>Arbitrum<br><br>‍</strong>Given the current state of Arbitrum’s financials in the section above, we explore possible changes to Arbitrum’s valuation with certain assumptions. As the expectation is for costs to significantly decrease post-EIP4844, one would expect profits and margins to increase given revenues are held constant.<br><br>With these, we modeled out a sensitivity table showing various possible outcomes for varying combinations of EIP4844 savings passed on to users (Y-axis) and EIP4844 cost reduction factors (X-axis, higher number = higher savings from EIP4844).<br><br>We have shaded in the combinations that we view as most likely post-EIP4844.</div><img src="images/ep9.webp" loading="lazy" sizes="(max-width: 767px) 96vw, (max-width: 991px) 728px, 940px" srcset="images/ep9-p-500.webp 500w, images/ep9-p-800.webp 800w, images/ep9-p-1080.webp 1080w, images/ep9.webp 1456w" alt="" class="image">
      <div>With 100% of the savings passed on to users we can assume that this cost savings could increase the number of transactions on Abritrum (new dApp types, more users).<br><br>Making a few assumptions:<br><br>- Keep current Price to earnings ratio (P/E)<br>- Assume a cost decrease by a factor of 10<br>- Transaction count grows due to savings<br><br>We can work out the price of ARB and OP for these changes. For example, if Tx count grows by 40% and only 90% of savings are passed on to users, that prices ARB at $2.10.<strong><br><br><br>Optimism <br><br>‍</strong>Carrying out the same exercise for Optimism, we arrive at the results below. </div>
    </div>
    <div class="w-layout-blockcontainer w-container"><img src="images/ep10.webp" loading="lazy" sizes="(max-width: 767px) 96vw, (max-width: 991px) 728px, 940px" srcset="images/ep10-p-500.webp 500w, images/ep10-p-800.webp 800w, images/ep10-p-1080.webp 1080w, images/ep10.webp 1456w" alt="" class="image"></div>
    <div class="w-layout-blockcontainer w-container">
      <div><strong>L2 Tokenomics &amp; Valuation<br><br></strong>Currently, the only value accrual towards Arbitrum and Optimism is governance; that is the only function for ARB and OP. However, ARB and OP value accrual could potentially come from two other sources: transaction fees and MEV. <br><br>In their current states, both L2 solutions rely heavily on their centralised sequencer and all the profits of this centralised block building and proposing is passed onto the Arbitrum foundation and Optimism foundation. However, both solutions have made promises to move toward a decentralised sequencer mechanism whereby the foundations are not the only entities building and proposing L2 blocks. The first step toward value accrual for L2 tokens is decentralising the sequencer, which is no easy feat, however, it could allow for the participation of L2 tokens holders in the value generated via the building and proposing process.<br><br>Decentralizing the sequencer would be likely achieved through a proof-of-stake mechanism where users would stake the native L2 token. Stakers would be slashed if they did not perform their duties or acted maliciously. Stakers could earn a portion of transaction fees, MEV (in a post FIFO world) or staking rewards in the form of the native token.<br><br>It is important to decentralize sequencers because centralized sequencers can lead to censored user transactions, become a bottle-neck, extract excessive rent or create harmful MEV and adversely affect users.</div>
    </div>
    <div class="w-layout-blockcontainer w-container"><img src="images/ep11.webp" loading="lazy" sizes="(max-width: 767px) 96vw, (max-width: 991px) 728px, 940px" srcset="images/ep11-p-500.webp 500w, images/ep11-p-800.webp 800w, images/ep11-p-1080.webp 1080w, images/ep11.webp 1456w" alt="" class="image"></div>
    <div class="w-layout-blockcontainer w-container"><img src="images/ep12.webp" loading="lazy" sizes="(max-width: 767px) 96vw, (max-width: 991px) 728px, 940px" srcset="images/ep12-p-500.webp 500w, images/ep12-p-800.webp 800w, images/ep12-p-1080.webp 1080w, images/ep12.webp 1456w" alt="" class="image"></div>
    <div class="w-layout-blockcontainer container-6 w-container">
      <a href="https://www.asxn.xyz/" class="button w-button">Subscribe to ASXN&#x27;s Newsletter</a>
      <a href="https://twitter.com/asxn_r" class="button w-button">Follow ASXN on Twitter</a>
    </div>
    <div class="w-layout-blockcontainer container-5 w-container"><img src="images/asxn-crest.jpeg" loading="lazy" sizes="(max-width: 479px) 92vw, 300px" srcset="images/asxn-crest-p-500.jpeg 500w, images/asxn-crest-p-800.jpeg 800w, images/asxn-crest-p-1080.jpeg 1080w, images/asxn-crest-p-1600.jpeg 1600w, images/asxn-crest-p-2000.jpeg 2000w, images/asxn-crest.jpeg 2481w" alt="" class="image crest"></div>
    <div class="w-layout-blockcontainer w-container">
      <div class="text-block-2"><strong>Disclaimer:</strong><em><br><br>The information and services above are not intended to and shall not be used as investment advice.You should consult with financial advisors before acting on any of the information and services. ASXN and ASXN staff are not investment advisors, do not represent or advise clients in any matter and are not bound by the professional responsibilities and duties of a financial advisor.Nothing in the information and service, nor any receipt or use of such information or services, shall be construed or relied on as advertising or soliciting to provide any financial services.</em></div>
    </div>
  </section>
  <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=6594359b0f0aa758b21d5c90" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="js/webflow.js" type="text/javascript"></script>
</body>
</html>